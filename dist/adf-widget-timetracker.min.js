!function(e,t){"use strict";function r(e){var t="0"+Math.floor(e/60),r="0"+(e-60*t);return t.substr(-2)+":"+r.substr(-2)}angular.module("adf.widget.timetracker",["adf.provider","tasker"]).config(["dashboardProvider",function(e){e.widget("timetracker",{title:"Time Tracker",description:"track billable hours to projects",templateUrl:"{widgetsPath}/timetracker/src/view.html",edit:{templateUrl:"{widgetsPath}/timetracker/src/edit.html"}})}]),$("#content").slimScroll({position:"right",height:"370px",railVisible:!0,alwaysVisible:!0,color:"#00c0ff",wheelStep:7});var n=angular.module("tasker",["angular-svg-round-progress","ngAnimate"]);n.run(["$rootScope",function(e){e.run=!1,e.hasState=!1}]),n.controller("tasks",["$scope","taskService",function(e,t){e.tasks=t.getAll(),e["delete"]=function(e){t.remove(e)}}]),n.controller("controls",["$scope","$rootScope","timeService","taskService",function(e,t,r,n){e.startpause=function(){t.run===!1?(t.run=!0,t.hasState=!0):t.run=!1},e.addnote=function(){t.run=!1,t.hasState=!1;var e=prompt("What have you done ?");null!=e&&""!==e.trim()?(n.add(e),t.$broadcast("RESET")):t.hasState=!0}}]),n.controller("currentPause",["$scope","$rootScope","$interval","timeService",function(e,t,n,s){e.max=s.getConfig("pause"),e.current=s.getConfig("pause"),e.currentText=r(e.current),e.$on("RESET",function(){e.current=s.getConfig("pause"),e.currentText=r(e.current)}),n(function(){!e.run&&e.hasState&&(e.current<=0&&t.hasState?(document.getElementById("alert").play(),t.hasState=!1):(e.current-=1,e.currentText=r(e.current),s.setPause(e.current)))},1e3)}]),n.controller("currentTask",["$scope","$rootScope","$interval","timeService",function(e,t,n,s){e.max=s.getConfig("time"),e.current=s.getConfig("time"),e.currentText=r(e.current),e.$on("RESET",function(){e.current=s.getConfig("time"),e.currentText=r(e.current)}),n(function(){e.run&&e.hasState&&(e.current<=0?(document.getElementById("alert").play(),t.hasState=!1):(e.current-=1,e.currentText=r(e.current),s.setTime(e.current)))},1e3)}]),n.factory("taskService",["timeService",function(e){var t="",r=[];if(""===t){var n=new Date;t+=n.getDay()+"/"+n.getMonth()+"/"+n.getFullYear()}return{add:function(n){r.push({date:t,note:n,time:e.getWorkedTime(!1),pause:e.getWorkedPause(!1),ftime:e.getWorkedTime(!0),fpause:e.getWorkedPause(!0)}),this.setPersistence()},remove:function(e){r.splice(e,1),this.setPersistence()},getAll:function(){return null===localStorage.getItem("codepen-tasker")&&this.setPersistence(),0===r.length&&this.getPersistence(),r},getPersistence:function(){r=JSON.parse(localStorage.getItem("codepen-tasker"))},setPersistence:function(){localStorage.setItem("codepen-tasker",JSON.stringify(r))}}}]),n.factory("timeService",[function(){var e={time:2400,pause:600},t=e.pause,n=e.time;return{reset:function(){t=e.pause,n=e.time},getConfig:function(t){return e[t]},getWorkedPause:function(n){return n?r(e.pause-t):e.pause-t},getWorkedTime:function(t){return t?r(e.time-n):e.time-n},getTime:function(){return n},getPause:function(){return t},setTime:function(e){n=e},setPause:function(e){t=e}}}]),angular.module("adf.widget.timetracker").run(["$templateCache",function(e){e.put("{widgetsPath}/timetracker/src/edit.html",'<form role=form><div class=form-group><label for=sample>Sample</label> <input type=text class=form-control id=sample ng-model=config.sample placeholder="Enter sample"></div></form>'),e.put("{widgetsPath}/timetracker/src/view.html",'<div id=head><div class=circles><div class=progress-wrapper ng-controller=currentPause id=pause><div class="progress pause" ng-show="run === false">{{currentText}}</div><div round-progress max=max current=current color=white bgcolor=#262b34 radius=70 stroke=10 semi=false rounded=false clockwise=false responsive=false duration=2400 animation=easeInOutQuart ng-class={dimmedpause:run}></div></div><div class=progress-wrapper ng-controller=currentTask><div class="progress task" ng-show="run === true">{{currentText}}</div><div round-progress max=max current=current color=#00c0ff bgcolor=#262b34 radius=70 stroke=3 semi=false rounded=false clockwise=false responsive=false duration=2400 animation=easeInOutQuart ng-class={dimmedplay:!run}></div></div></div><div class=interaction ng-controller=controls><span class=btn ng-click=startpause()><i class="mdi mdi-pause" ng-show="run === true"></i><i class="mdi mdi-play" ng-show="run === false"></i></span> <span class="btn primary" ng-click=addnote()><i class="mdi mdi-plus"></i></span></div></div><div id=content ng-controller=tasks><div style=text-align:center ng-hide="tasks.length > 0"><h2 style="margin:20px 0 0 0;">Oh :(</h2><h3 style=margin:0;>You have no recorded tasks yet - that makes me sad</h3></div><input placeholder=Filter ng-show="tasks.length > 0" type=text id=filter ng-model=taskfilter><ul><li class=list-animation ng-repeat="task in tasks | filter: taskfilter track by $index"><span class=date>{{task.date}}</span> <b>{{task.note}}</b><span class=right><span class=time>{{task.ftime}}</span><span class=pause>{{task.fpause}}</span><i class="mdi mdi-delete" ng-click=delete($index)></i></span></li></ul></div><audio id=alert src=https://dl.dropboxusercontent.com/u/2449512/roundhouse.wav preload=auto></audio>')}])}(window);